\documentclass[11pt,a4paper]{ivoa}
\input tthdefs
% widen up the display a bit so that 75 column listings still fit on
% the page
\usepackage[width=14cm,left=4cm]{geometry}
\usepackage{listings}
\lstloadlanguages{XML}
\lstset{flexiblecolumns=true,tagstyle=\ttfamily,showstringspaces=False}
\usepackage{todonotes}

\iftth
\newcommand{\tapschema}{TAP\_SCHE\-MA}
\hyphenation{TAP\_SCHEMA}
\hyphenation{\tapschema}
\newcommand{\tapupload}{TAP\_UPLOAD}
\else
\newcommand{\tapschema}{\mbox{%
  TAP\discretionary{-}{}{\kern-2pt\_}SCHEMA}}
\newcommand{\tapupload}{%
  TAP\discretionary{-}{}{\kern-2pt\_}UPLOAD}
\fi

\title{VODataService: A VOResource Schema Extension for Describing
Collections and Services}

\ivoagroup{Registry}

\author[http://www.ivoa.net/twiki/bin/view/IVOA/RayPlante]{Raymond Plante}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/MarkusDemleitner]{Markus Demleitner}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/AurelienStebe]{Aurélien Stébé}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/KevinBenson]{Kevin Benson}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/PatrickDowler]{Patrick Dowler}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/MatthewGraham]{Matthew Graham}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/GretchenGreene]{Gretchen Greene}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/PaulHarrison]{Paul Harrison}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/GerardLemson]{Gerard Lemson}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/TonyLinde]{Tony Linde}
\author[http://www.ivoa.net/twiki/bin/view/IVOA/GuyRixon]{Guy Rixon}

\editor{Markus Demleitner}
\editor{Ray Plante}

\previousversion[http://www.ivoa.net/Documents/VODataService/20101202]{REC
1.1}
\previousversion[http://www.ivoa.net/Documents/VODataService/20100916]{PR-20100916}
\previousversion[http://www.ivoa.net/Documents/VODataService/20100914]{PR-20100914}
\previousversion[http://www.ivoa.net/Documents/VODataService/20100412]{PR-20100412}
\previousversion[http://www.ivoa.net/Documents/VODataService/20090903]{PR-20090903}
\previousversion[http://www.ivoa.net/Documents/WD/ReR/VODataService-20090508.html]{WD-20090508}
     

\begin{document}
\begin{abstract}
VODataService refers to an XML encoding standard for a specialized
extension of the IVOA Resource Metadata that is useful for describing
data collections and the services that access them.  It is defined as
an extension of the core resource metadata encoding standard known as
VOResource \citep{2018ivoa.spec.0625P} using XML Schema.
The specialized resource types defined by the VODataService schema
allow one to describe how the data underlying the resource cover the
sky and the frequency and time axes.  
VODataService also enables detailed
descriptions of tables that includes information useful to the
discovery of tabular data.  It is intended that the VODataService data
types will be particularly useful in describing services that support
standard IVOA service protocols.  
\end{abstract}

\section*{Acknowledgments}

Versions 1.0 and 1.1 of this document have been developed with support from the
National Science Foundation's
Information Technology Research Program under Cooperative Agreement
AST0122449 with The Johns Hopkins University, from the
UK Particle Physics and Astronomy
Research Council (PPARC), from the European Commission's (EC)
Sixth
Framework Programme via the 
Optical Infrared Coordination Network (OPTICON), and from EC's
Seventh Framework Programme
via its
eInfrastructure Science Repositories initiative.

Version 1.2 of this document was developed in part with support from the
German federal ministry for research and education's e-inf-astro project (BMBF
FKZ 05A17VH2).


\section*{Conformance-related definitions}

The words ``MUST'', ``SHALL'', ``SHOULD'', ``MAY'', ``RECOMMENDED'', and
``OPTIONAL'' (in upper or lower case) used in this document are to be
interpreted as described in IETF standard RFC2119 \citep{std:RFC2119}.

The \emph{Virtual Observatory (VO)} is a
general term for a collection of federated resources that can be used
to conduct astronomical research, education, and outreach.
The \href{http://www.ivoa.net}{International
Virtual Observatory Alliance (IVOA)} is a global
collaboration of separately funded projects to develop standards and
infrastructure that enable VO applications.


\section*{Syntax Notation Using XML Schema}

The eXtensible Markup Language, or XML, is a document syntax for marking
textual information with named tags and is defined by \citet{std:XML}.
The set of XML tag names and the syntax
rules for their use is referred to as the document schema.  One way to
formally define a schema for XML documents is using the W3C standard
known as XML Schema \citep{std:XSD}.

The XML Schemas of VODataService as well as VOResource and its other
extensions are
available from the IVOA document
repository\footnote{\url{http://www.ivoa.net/xml}} at any time.
Parts of the schema appear within the main sections of this document;
however, documentation nodes have been left out for the sake of brevity.
Where the content of the pieces of schema embedded in this text
diverges from the schema document in the IVOA document
repository, the version in the schema repository is authoritative.

References to specific elements and types defined in the VOResource
schema include the namespaces prefix \xmlel{vr} as in
\xmlel{vr:Resource} (a type defined in the VOResource schema).

The
recommended namespace prefix for VODataService as per Registry
Interfaces 1.1 \citep{2018ivoa.spec.0723D}, sect.~2.2, is \xmlel{vs}.

\section{Introduction}

The VOResource standard \citep{2018ivoa.spec.0625P} provides a means of
encoding resource metadata as defined by DataCite \citep{std:DataCite40}
and the VO-specific IVOA Resource Metadata \citep{2007ivoa.spec.0302H} in XML.
VOResource uses XML Schema \citep{std:XSD} to define
most of the XML syntax rules (while a few of the syntax rules are
outside the scope of Schema).  VOResource also describes mechanisms
for creating extensions to the core VOResource metadata.  This allows
for the standardization of new metadata for describing specialized
kinds of resources in a modular way without deprecating the core
schema or other extensions.  

This document defines one such extension referred to as VODataService.
It provides types to define data services, their underlying tabular
structures, their service interfaces, and the location of the data
served in space, time, and energy.


\subsection{The Role in the IVOA Architecture}

\begin{figure}
\centering
\includegraphics[width=0.9\textwidth]{role_diagram.pdf}
\caption{Architecture diagram for VODataService}
\label{fig:archdiag}
\end{figure}

Fig.~\ref{fig:archdiag} shows the role VODataService plays within the
IVOA Architecture \citep{note:VOARCH}.

VODataService directly depends on the following other VO standards
(unless specified otherwise, the dependency is on the major version of
the cited standard rather than on the exact version):

\begin{description}
\item[VOResource, v1.1 \citep{2018ivoa.spec.0625P}] VOResource provides
the fundamental types and structures extended here.
\item[STC, v1.33 \citep{2007ivoa.spec.1030R}] The deprecated mechanism
for declaring coverage through STCResourceProfile still uses concepts
from verion 1 of the IVOA data model for Space-Time Coordinates.  The
updated mechanism has no such dependence any more.
\end{description}

VODataService is closely related to the following other VO standards:

\begin{description}
\item[VOSI, v1.1 \citep{2017ivoa.spec.0524G}] VODataService defines the
schema for the responses on the table metadata endpoint.  It also
defines the ParamHTTP interface type used in the capabilities of most
standard protocols.
\item[RefTAP, v1.0 \citep{2014ivoa.spec.1208D}] RegTAP maps the concepts
defined here into a relational structure.  In that sense it provides the
user interface to what is specified here.
\end{description}

\subsection{Purpose}


The purpose of this extension is to define common XML Schema
types -- particularly new resource types -- that are useful for describing
data collections and services that access data.  In particular, it
allows one to describe the data's \emph{coverage}:  the parts of the
sky with which the data are associated and the time and frequency ranges that
were observed or modeled to create the data.  It also allows one to
describe tables in detail.  In particular, one can describe each of
the columns of a table -- providing, for example, its name, type, UCD
\citep{2005ivoa.spec.1231D}, unit,
and textual description.  When this metadata is part of a resource
description in a registry, it becomes possible
to discover tables that contain particular kinds of data.  



Resource records using VODataService types are commonly used to register
services that support standard IVOA data access layer protocols such
as Simple Image Access \citep{2015ivoa.spec.1223D} and Simple Cone Search
\citep{2008ivoa.specQ0222P}.  As of October 2018, there are more than
20000~resources of type \xmlel{vs:CatalogService} in the VO Registry.

While other VOResource extensions 
define the protocol-specific metadata (encapsulated as a standard
\emph{capability} from VOResource), the general service
resource description shares the common data concepts such as
coverage and tabular data.  Note, however, that a service described
using the VODataService schema need not support any standard
protocols.  With the VODataService extension schema plus the core
VOResource schema, it is possible to describe a custom service
interface that accesses data.  



As a legal extension of VOResource, the use
of VODataService is subject to the rules and recommendations for XML
\citep{std:XML}, XML Schema \citep{std:XSD},
and VOResource itself.  

\subsection{Additional Use Cases for Version 1.2}

In the following, we collect use cases that guided the development of
VODataService to its version 1.2.  We do not formally derive
requirements from them but briefly note which new features enable or
facilitate the specific use case.

A few of the changes are necessary for consistency with other standards
such as TAP (extendedType interpretation, requirement to use ADQL
delimited identifier literals in names where appropriate) or VOTable
(arraysize interpretation).  These were obviously not guided by specific
use cases.


\paragraph{What services have data for the Crab nebula covering the H$\alpha$ 
line taken in the second half of 2015?}  In version 1.1, this use case
would have been covered by the \xmlel{stc:STCResourceProfile} type,
which was never properly standardised or widely adopted.  In the current
version, the \xmlel{spatial}, \xmlel{spectral}, and \xmlel{temporal}
children of \xmlel{coverage} enable discovery by coverage on the various
axes.  It is worth noting that the spectral coverage is for the solar
system barycenter, so this use case does \emph{not} immediately enable
the discovery of, say, H$\alpha$ images of remote galaxies.  Redshift
correction has to be applied by the client based on knowledge about the
object(s) investigated.\todo{Also, we don't do solar system well
spatially.  Mention this here?  Fix it now?}

\paragraph{Find all ObsCore services publishing data taken at the
Telescope X.} This use case could be satisfied in version 1.1 through
the use of \xmlel{vs:DataCollection} records and relationships to the
respective TAP services.  However, this scheme led to error-prone query
patterns, and few such data collections were actually registered; see
the IVOA Note on Discovering Data Collections \citep{note:DataCollect} for
details.  To better support the scheme proposed there, version 1.2 adds
the \xmlel{vs:DataResource} and \xmlel{vs:CatalogResource} types 
that identify a resource as data-like but
allows the addition of various capabilities to the record (which
\xmlel{vs:DataCollection} did not).  An analogous use case would be
``Find all TAP services publishing tables from Gaia DR2''.

\paragraph{Find a large-scale survey of sources between 20 and 40 GHz.}
While the spectral constraint is easily satisfied by the new coverage
children, the ``large-scale'' part is much harder to operationalize.
However, the plain table size often is a useful proxy in such discovery
problems.  The new \xmlel{nrows} child of \xmlel{vs:Table} communicates
it.

\paragraph{Find a resource that has sources in M51 down to 27 mag in V.}
The constraint about finding a resource that has V magnitudes for M51 is
expressible using spatial coverage and the column's UCDs.  To express
something like ``down to $27^{\rm m}$'' one would at least need
VOTable-style \xmlel{VALUES} children for columns.\todo{Do we want
that?}

\paragraph{Plan a cross-service query.} Systems like OGSA-DAI
\citep{2011ASPC..442..579H} perform orchestration of SQL-like queries
between multiple services automatically, in particular cross-service
JOINs.  In order to work efficiently, such services need column
statistics like histograms and the percentage of NULL values.\todo{Do we
want this?  If so, what exactly?}

\paragraph{Find services serving time series.} In the current registry
model, users looking for spectra would select SSAP services.  With the
growing adoption of ObsCore (and a growing number of services abusing
SSAP to serve time series), the model of selecting data types by
constraining the service protocol no longer works; in the ObsCore
example, clients now have to query all services and constrain the
\verb|dataproduct_type| column. However, for dataset types not overly
common, well more than 90\% of the services could be excluded without
sending a query there based on a declaration of dataset types available
in the Registry.\todo{Actually, a VOTable VALUES workalike would be
enough for that and ObsCore.  But: SIAv2?  Data collections, perhaps?}

\paragraph{Facilitate discovery of full DALI services.}  The issue here
is that DALI forsees synchronous and asynchronous endpoints as the
standard case for many protocols -- it already is standard for TAP.  The
current way to discover these, together with the pertinent VOSI
endpoints, is built on \xmlel{vs:ParamHTTP}-typed interfaces and has
known weaknesses, in particular when multiple authentication schemes
necessitate multiple sync/async pairs.\todo{See what UWSRegExt brings.}



\section{The VODataService Data Model}


The VODataService extension in general enables the description of two
types of resources:  data collections and services that access data.
Here's an example of a VOResource document (abbreviated for the
purposes of illustration) that describes a service from the NASA
Extragalactic Database (NED) that provides measured redshifts for a
given object.


\lstinputlisting[language=XML,basicstyle=\footnotesize,numbers=left]{ipac-resource.xml}

This example illustrates some of the features of the VODataService
extension:

\begin{enumerate}
\item The specific type of resource indicated by
       the value of the \xmlel{xsi:type} attribute; in this case
       \xmlel{vs:CatalogService} indicates that this is
       describing a service that accesses tabular data (line 1).
\item The extra namespace declaration for with
       VODataService metadata with the canonical prefix (line 5).
\item The location of the VOResource-related schema 
       documents used by this description (line 7ff.)
\item The core VOResource metadata (line 12ff.)
\item An interface described by the
       VODataService type \xmlel{vs:ParamHTTP}; this
       type can indicate input arguments the service supports (line
       40ff.)
\item A description of the
       coverage, including quantitative coverage
       plus waveband keywords (line 62ff.)
\item A description of the table that is returned
       by the service (line 73ff.)
\end{enumerate}

\subsection{The Schema Namespace and Location}


The namespace associated with VODataService extensions is
$$\mbox{\texttt{http://www.ivoa.net/xml/VODataService/v1.1}}.$$
As required by the IVOA schema versioning policies
\citep{2018ivoa.spec.0529H}, this namespace is identical to the one
associated with version 1.1 of this document.  It is regrettable that a
misleading minor version is present in the namespace URI, but dropping
it would break existing software for creating and processing
VODataService instance documents.  Hence, the namespace URI ending in
\verb|1.1| is also used for versions 1.2, 1.3, and so forth of the
schema.

Resolving the VODataService namespace URI will redirect to a schema
document having the actual version number (for the schema associated
with this document version, this will end in VODataService-1.2.xsd).
Following the schema versioning policies, the minor version will be
declared in the \xmlel{version} attribute of this file's root element.
This information should not in general be used in production software;
all versions with the above schema URI are compatible with each
other in the sense defined in the IVOA schema versioning policies.

The versioning policies in version 1.0 posit a requirement that instance
documents declare the minor version of the schema used to produce them
in the root element of elements coming from a schema.  VODataService has
no global elements, and hence there is no place for such a declaration,
nor is it needed.


Authors of VOResource instance documents may choose to
provide a location for the VOResource XML Schema document and its
extensions using the
\xmlel{xsi:schemaLocation} attribute.  While authors are free to
choose a location (as long as it resolves to the schema document), this
specification
recommends using the VODataService namespace URI as its location URL
(as illustrated in the example above), as in,

\begin{lstlisting}[language=XML]
xsi:schemaLocation="http://www.ivoa.net/xml/VODataService/v1.1
                    http://www.ivoa.net/xml/VODataService/v1.1"
\end{lstlisting}


\begin{admonition}{Note}
The IVOA Registry Interface standard \citep{2018ivoa.spec.0723D}
       actually \emph{requires} that the VOResource records it
       shares with other registries provide location URLs via
       \xmlel{xsi:schemaLocation} for the VOResource schema and
       all legal extension schemas that are used in the records.  This
       rule would apply to the VODataService schema.
\end{admonition}


The canonical prefix for VODataService is \xmlel{vs}; this means, in
particular, that in non-XML contexts (e.g., relational mappings
like RegTAP) the VODataService types \emph{must} be qualified with
vs:.  The Registry Interfaces standard \citep{2018ivoa.spec.0723D} also
strongly recommends using the canonical prefixes in XML documents.

Note also that in this document, the \xmlel{vr} prefix is used to
label, as shorthand, a type or element name that is defined in the
VOResource schema, as in \xmlel{vr:Resource}.




As recommend by the VOResource standard, the
VODataService schema sets \xmlel{element\-Form\-Default} to \emph{unqualified}.
This means that element names defined
in this schema may not be used with a namespace prefix.
The only place the namespace prefix must be used is the
type names given as the value of an
\xmlel{xsi:type} attribute.  


\subsection{Summary of Metadata Concepts}
\label{sect:summ}


VODataService defines several resource types and some auxiliary classes
necessary to describe resources of these new types.

\subsubsection{Auxiliary Classes}

The VODataService type \xmlel{vs:Coverage} allows the declaration of
the physical coverage of a resource on the sky (or on spherical bodies),
in time, and in the energy of the messenger particle.  In addition, the
element should contain a rough indication of the messenger type
(``Optical''), and it can contain a link to a footprint service and an
indication of the spatial resolution within a service.

VODataService has several classes for the declaration of the tabular
structure underlying a service; this can be the tables in a TAP service,
or it can relate to the data structure returned by the service.  A
\xmlel{vs:TableSet} consists of one or more (possibly anonymous)
\xmlel{vs:TableSchema} instances.  These have some very basic metadata
(name, title, description, utype) and otherwise contain \xmlel{vs:Table}
instances.  These in turn have simple metadata, but mainly give column
metadata (including UCDs and units) in \xmlel{vs:TableParam}-typed
children.  These are the basis for enabling discovery queries like
``find all resources having redshifts and far infrared fluxes''.

Note that table and schema metadata is deliberately shallow.  If the
main resource metadata is not enough to discover the table -- as is
fairly typical when a TAP service contains multiple unrelated tables --,
data providers should define separate records for them as described in
the Note on Discovering Data Collections.

VODataService further defines a specialized interface type
(inheriting from \xmlel{vr:Interface}) called
\xmlel{vs:ParamHTTP}.  This type is used to describe
straightforward HTTP interfaces directly operating on
arguments encoded as
\emph{name=value} pairs.  Such interface declarations can
enumerate a service's input arguments, which enables clients
to generate simple
user interfaces from VOSI capabilities responses.

To be able to express the types of table columns and service arguments
alike, VODataService defines several type systems.  All of these are
basically just enumerations of type names, possibly with some additional
metadata like VOTable-style array sizes.  In new resource records, only
\xmlel{vs:SimpleDataType} (for ParamHTTP interface parameters) and
\xmlel{vs:VOTableType} (for table columns) should be used.

\subsubsection{VODataService Resource Classes}

\begin{figure}
\includegraphics{resclasses.pdf}
\caption{The four major resource classes in VODataService and their
derivation tree}
\label{fig:rescls}
\end{figure}

While no common VO service discovery pattern relies on the type  of the
resource,\footnote{Of course, in non-service discovery (e.g., authorities
or standards), resource types are important.} resource
record authors should
nevertheless choose appropriate types for their resources.  At the
very least, this helps in Registry maintenance.

VODataService provides four major resource classes; their derivation
tree is shown in Fig.~\ref{fig:rescls}.  The vertical distinction in
that figure reflects whether a resource has an associated tableset
(DataX vs.~CatalogX); you would typically use the DataX types when a
resource does not naturally admit a relational structure.  The classical
example for this would be a collection of files on an FTP server.  CatalogX,
on the other hand, has an associated tableset.  That does not mean that
it is limited to what is conventionally thought as a ``catalogue'',
i.e., a collection of metadata on astronomical objects.  On the
contrary, CatalogX should also be used for collections of images,
spectra, time series, etc, as long as their metadata is sufficiently
structured.  Accessibility through IVOA standard protocols (ObsCore,
SIAP, SSAP) certainly satisfies that requirement.

The horizontal distinction (XResource vs.~XService) is somewhat more
subtle, as the content model of XResource and XService are identical.
Choose XResource when the resource is mainly accessible as part of
another service; the classical example would be a table (or schema) in a
TAP service or a collection of images or spectra within an ObsTAP
service.  These should then have mainly auxiliary capabilities (where
a capability with a \xmlel{vr:WebBrowser}-typed interface to, say, an
form-based access point does not preclude the use of XResource).  
Choose XService when
there is a 1:1 relationship between the publishing service and the
published data or the resource published multiple data collections
registered in XResource records.


Two further resource classes defined VODataService 1.1,
\xmlel{vs:DataCollection} and \xmlel{vs:StandardSTC}, 
are deprecated in version 1.2.  
Resource record authors are requested to migrate or discard resource
records using these deprecated types.  If all such records have
disappeared from the VO by version 1.3 of this specification, their
type declarations may be removed from the schema.


\section{The VODataService Metadata}
\label{sect:metadata}


This section enumerates the types and elements defined in the
VODataService extension schema and describes their meaning.  Where a
term matches a term in the RM, its meaning is given
in terms of the RM definition.  


\subsection{VODataService Resource Types}
\label{sect:resext}

\subsubsection{DataResource}
\label{sect:DataResource}

The \xmlel{vs:DataResource} resource type is for describing a
resource containing generic astronomical data without a dominating
tabular structure.  An example might be a largely unstructured archive
of various observations.  Resources that have structured metadata tables
(like most VO services) or are tabular in nature (like usual
astronomical catalogs) should use \xmlel{vs:CatalogResource}.

The type is derived from \xmlel{vr:Service}, which means that instances
can have
capabilities.  For \xmlel{vs:DataResource}, only auxiliary capabilities
(e.g., TAP services giving access to the table) or plain capabilities
with \xmlel{vr:WebBrowser} interfaces should be given.  Resources with a
primary access mode dedicated to the resource's data content should use
\xmlel{vs:DataService}-typed resources.

In addition to \xmlel{vr:Service}'s content, DataResource adds
elements for declaring the observing facilities and/or instruments used
to obtain the data, and it allows to declare
the coordinate coverage of data via the \xmlel{coverage}
element.

% GENERATED: !schemadoc VODataService-v1.2.xsd DataResource
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:DataResource} Type Schema Documentation}

\noindent{\small
           A resource publishing astronomical data.
         \par}

\noindent{\small
            This resource type should only be used if the resource has no
            common underlying tabular schema (e.g., an inhomogeneous archive)
            Use CatalogResource otherwise.
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:DataResource} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="DataResource" >
  <xs:complexContent >
    <xs:extension base="vr:Service" >
      <xs:sequence >
        <xs:element name="facility" type="vr:ResourceName" minOccurs="0"
                  maxOccurs="unbounded" />
        <xs:element name="instrument" type="vr:ResourceName" minOccurs="0"
                  maxOccurs="unbounded" />
        <xs:element name="coverage" type="vs:Coverage" minOccurs="0" />
      </xs:sequence>
    </xs:extension>
  </xs:complexContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:DataResource} Extension Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{facility}]
\begin{description}
\item[Type] string with ID attribute: vr:ResourceName
\item[Meaning] 
                     the observatory or facility used to collect the data 
                     contained or managed by this resource.  
                   
\item[Occurrence] optional; multiple occurrences allowed.

\end{description}
\item[Element \xmlel{instrument}]
\begin{description}
\item[Type] string with ID attribute: vr:ResourceName
\item[Meaning] 
                     the Instrument used to collect the data contain or 
                     managed by a resource.  
                   
\item[Occurrence] optional; multiple occurrences allowed.

\end{description}
\item[Element \xmlel{coverage}]
\begin{description}
\item[Type] composite: \xmlel{vs:Coverage}
\item[Meaning] 
                     Extent of the content of the resource over space, time, 
                     and frequency.
                   
\item[Occurrence] optional

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED

\subsubsection{DataService}

The \xmlel{vs:DataService} resource type has the same content model as
\xmlel{vs:DataResource}.  It should be used instead of
\xmlel{vs:DataResource} when the resource's capabilties give
access to (essentially) only the resource's data, as for instance
``ftp service for the XY instrument'', or for a service giving access
to multiple resources; in this latter case, the resource-level
metadata should pertain to the service itself rather than any specific
data collection served by it.

Note that whenever the service operates on clearly definable tabular
data, the \xmlel{vs:CatalogService} resource type should be used in
preference to \xmlel{vs:DataService}.

DataService's content model is exactly the one of
\xmlel{vs:DataResource}; please refer to sect.~\ref{sect:DataResource}.




\subsubsection{CatalogResource}
\label{sect:CatalogResource}


The \xmlel{vs:CatalogResource} resource type is for describing a
resource containing astronomical data or metadata in a set of one or
more tables.  It extends \xmlel{vs:DataResource} and thus has metadata
on coverage and the facilities and instruments that produced the
resource.  Additionally, this type allows the
declaration of the metadata of the table(s) underlying the data or
delivered by it in a tableset element.

As with \xmlel{vs:DataResource}, this type should only be used if all
capabilities declared in the resource are either auxiliary or
nonstandard.  This is typically the case for catalogs or data
collections with in larger TAP, ObsTAP, or perhaps SIAP services.  When
a service only publishes a single resource, use the
\xmlel{vs:CatalogService} type.

This is the type that should be used for publishing data collections
according to the IVOA Note on Discovering Data Collections 
\citep{note:DataCollect}.


% GENERATED: !schemadoc VODataService-v1.2.xsd CatalogResource
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:CatalogResource} Type Schema Documentation}

\noindent{\small
            A resource giving astronomical data in tabular form.
         \par}

\noindent{\small
            While this includeds classical astronomical catalogues,
            this resource is also appropriate for collections of observations
            or simulation results provided their metadata are available
            in a sufficiently structured form (e.g., Obscore, SSAP, etc).
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:CatalogResource} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="CatalogResource" >
  <xs:complexContent >
    <xs:extension base="vs:DataResource" >
      <xs:sequence >
        <xs:element name="tableset" type="vs:TableSet" minOccurs="0" >
          <xs:unique name="CatalogService-schemaName" >
            <xs:selector xpath="schema" />
            <xs:field xpath="name" />
          </xs:unique>
          <xs:unique name="CatalogService-tableName" >
            <xs:selector xpath="schema/table" />
            <xs:field xpath="name" />
          </xs:unique>
        </xs:element>
      </xs:sequence>
    </xs:extension>
  </xs:complexContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:CatalogResource} Extension Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{tableset}]
\begin{description}
\item[Type] composite: \xmlel{vs:TableSet}
\item[Meaning] 
                       A description of the tables that are accessible
                       through this service.
                     
\item[Occurrence] optional
\item[Comment] 
                       Each schema name and each table name must be
                       unique within this tableset.
                     

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED


\subsubsection{CatalogService}

The \xmlel{vs:CatalogService} resource type is for describing a
service publishing astronomical data or metadata based on tabular
representations.  Its relationship to \xmlel{vs:CatalogResource}
is as between \xmlel{vs:DataResource}
and \xmlel{vs:DataService}: Use \xmlel{vs:CatalogService} when either
the resource's capabilties are exclusive to the resource described by
the resource-level metadata (``SSAP service for the XY instrument'') or
if the service publishes multiple other CatalogResources; in that latter
case, again, the resource-level metadata should not refer to any
specific data collection contained.

This is the type that should be used for typical, one-resource VO
services.

CatalogService's content model is exactly the one of
\xmlel{vs:CatalogResource}; please refer to sect.~\ref{sect:CatalogResource}.

\subsubsection{DataCollection}
\label{sect:datacollection}

The \xmlel{vs:DataCollection} type is deprecated and should no longer be
used in new resource records.  It was used in version 1.1 to define
simple collections of data, much like \xmlel{vs:CatalogResource} in the
current version.  It did not admit capabilities, though, and since the
addition of capabilities would essentially have created a CatalogService
clone with a different child sequence, it was decided to abandon rather
than repair it.

Existing \xmlel{vs:DataCollection}-typed
records should be migrated to \xmlel{vs:DataResource} or
\xmlel{vs:CatalogResource} as appropriate.  If \xmlel{accessURL}
children are present in the
\xmlel{vs:DataCollection}s,
they can be replaced with a plain capability with a
\xmlel{vr:WebBrowser}-typed interface.

This type may be removed from the schema when all resource records using
it have vanished from the VO Registry.

\subsubsection{StandardSTC}

The \xmlel{vs:StandardSTC} type is deprecated and should no longer be
used in new resource records.  Since the XML serialisation of the STC 1
data model was never promoted to an IVOA recommendation, there also is
no properly standardised way of creating such records.  Since no such
records ever existed in the Registry, this type will probably be removed
from the schema in version 1.3 of this specification.



\subsection{Coverage in Space, Time, and Spectrum}
\label{sect:cover}

The \xmlel{vs:Coverage} type summarily describes how the data served is
distributed on the
sky, in energy, and in time.  For the energy coverage, there is a
also qualitative classification in the \xmlel{waveband} \todo{Worry 
about non-EM messengers in waveband (use a vocabulary?)} element.

Historically, the quantitative footprints were expected to be given in
the element of type \xmlel{stc:STCResourceProfile}.  As discussed in
\citet{note:regstc}, this expectation turned out to be erroneous,
and the underlying standard, STC-X \citep{note:stcx}, never proceeded to become
a recommendation.  Hence, this version of VODataService deprecates the
use of \xmlel{STCResourceProfile}.

Instead, resource record authors are strongly encouraged to provide
coverage information in the \xmlel{spatial}, \xmlel{spectral}, and
\xmlel{temporal} children of \xmlel{coverage}.

Spatial coverage is conveyed as a MOC.  To enable easy embedding into
resource records written in VOResource (i.e., XML), 
we represent MOCs in the ASCII convention
proposed in the MOC specification \citep{2014ivoa.spec.0602F}.\todo{We
need a REC to cite -- DALI? us? VOTable?}

By default, the MOCs are to be interpreted in the ICRS.  It is forseen
that future extensions \todo{We should really do this now -- proposals,
anyone?} to this will allow non-celestial frames (e.g., on planet
surfaces).  However, the only celestial reference system allowed is
ICRS.  If a resource's coordinates are natively in another frame (e.g.,
Galactic or FK4 for some equinox), it is the resource record author's
responsibility to convert the spatial coverage into the ICRS.

An important characteristic of MOCs is the order of the smallest scale
(the ``MOC resolution'').  Higher orders yield more faithful
representations of the actual coverage, but also lead to a possibly
significant increase of the size of the serialized MOC.  We suggest a
``typical resolution'' of the Registry of about a degree (i.e., MOC
order 6), but resources are free to choose a higher maximum orders if
appropriate and the resource record size remains reasonable.

Resources that need to communicate high-resolution spatial coverage,
perhaps for some non-discovery use case, can use the \xmlel{footprint}
element with its \xmlel{ivo-id} attribute set to
\nolinkurl{ivo://ivoa.net/std/moc} to declare a URL giving a MOC 
footprint of arbitrary level and size; however, MOCs returned from
footprint services must be in the MOC FITS serialisation.

Time and spectral coverage are modeled as unions of simple
intervals over real numbers; the serialisation here is a space-separated
pair of floating point numbers as governed by the DALI \emph{interval}
xtype.

Times are given in Barycentric Dynamical Time (TDB) at the solar system
barycenter.  They must be specified as Modified Julian Dates.  Since
discovery use cases in which high-precision times are required are not
forseen, resource record authors are encouraged to pad their actual
temporal coverage such that differences in time scales (of the order of
10s of seconds) or reference positions (of the order of minutes between
ground-based observatories and the barycenter) do not matter.  In other
words, the temporal resolution of the Registry at this point should be
assumed to be of order 10 minutes.

Deviating from common VO practice (which currently fairly consistently
uses wavelengths of elecromagnetic waves in vacuum), spectral limits are
given in Joules of messenger energy.  This is intended to allow seamless
integration of non-electromagnetic messengers.  The reference position
for the spectral axis is the solar system barycenter.  Again, discovery
use cases on a level where the difference between reference frames of
ground-based observatories versus the solar system barycenter matters
are not forseen, and resource record authors are advised to pad their
intervals on that level.

% GENERATED: !schemadoc VODataService-v1.2.xsd Coverage
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:Coverage} Type Schema Documentation}

\noindent{\small
           A description of how a resource's contents or behavior maps
           to the sky, to time, and to frequency space, including
           coverage and resolution. 
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:Coverage} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="Coverage" >
  <xs:sequence >
    <xs:element ref="stc:STCResourceProfile" minOccurs="0" />
    <xs:element name="spatial" type="xs:string" minOccurs="0" />
    <xs:element name="temporal" type="vs:FloatInterval" minOccurs="0"
              maxOccurs="unbounded" />
    <xs:element name="spectral" type="vs:FloatInterval" minOccurs="0"
              maxOccurs="unbounded" />
    <xs:element name="footprint" type="vs:ServiceReference" minOccurs="0" />
    <xs:element name="waveband" type="vs:Waveband" minOccurs="0"
              maxOccurs="unbounded" />
    <xs:element name="regionOfRegard" type="xs:float" minOccurs="0" />
  </xs:sequence>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:Coverage} Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{}]
\begin{description}
\item[Type] 
\item[Meaning] 
                 An STC 1.0 description of the location of the resource's 
                 data on the sky, in time, and in frequency space, 
                 including resolution.   This is deprecated in favour
                 of the separate spatial, temporal, and spectral elements.
               
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{spatial}]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
                  An ASCII-serialized MOC defining the spatial coverage 
                  of the resource.
               
\item[Occurrence] optional
\item[Comment] 
                  The MOC is to be understood in the ICRS reference frame.
                  Resources should give the coverage at least to order 6
                  (a resolution of about one degree).  The order should be
                  chosen so as to keep the resulting MOC smaller than a few
                  dozens of kB.  If desired, a more precise MOC can be provided
                  on a dedicated endpoint declared in the footprint element.
               

\end{description}
\item[Element \xmlel{temporal}]
\begin{description}
\item[Type] string of the form: \emph{[+-]?([0-9]+$\backslash$.?[0-9]*|$\backslash$.[0-9]+)([eE][+-]?[0-9]+)? [+-]?([0-9]+$\backslash$.?[0-9]*|$\backslash$.[0-9]+)([eE][+-]?[0-9]+)?}
\item[Meaning] 
                  A pair of lower, upper limits of a time interval 
                  for which the resource offers data.
               
\item[Occurrence] optional; multiple occurrences allowed.

\item[Comment] 
                  This is written as for VOTable tabledata (i.e., 
                  white-separated C-style floating point literals).
                  The limits must be given as MJD.  While they
                  are not intended to be precise, they are to be understood
                  in TDB for the solar system barycenter.  The total coverage
                  of the resource is the union of all such intervals.
               

\end{description}
\item[Element \xmlel{spectral}]
\begin{description}
\item[Type] string of the form: \emph{[+-]?([0-9]+$\backslash$.?[0-9]*|$\backslash$.[0-9]+)([eE][+-]?[0-9]+)? [+-]?([0-9]+$\backslash$.?[0-9]*|$\backslash$.[0-9]+)([eE][+-]?[0-9]+)?}
\item[Meaning] 
                  A pair of lower, upper limits of a spectral interval 
                  for which the resource offers data.
               
\item[Occurrence] optional; multiple occurrences allowed.

\item[Comment] 
                  This is written as for VOTable tabledata (i.e., 
                  white-separated C-style floating point literals).
                  The limits must be given in Joules of particle
                  energies.  While the limits are not intended 
                  to be precise, they are to be understood for the
                  solar system barycenter.
               
\item[Comment] 
                  For instance, the Johnson V waveband (480 .. 730 nm)
                  would be specified as “2.72e-19 4.14e-19”
               

\end{description}
\item[Element \xmlel{footprint}]
\begin{description}
\item[Type] a URI with optional attributes
\item[Meaning] 
                  a reference to a footprint service for retrieving 
                  precise and up-to-date description of coverage.  
               
\item[Occurrence] optional
\item[Comment] 
                  the ivo-id attribute refers to a Service record
                  that describes the Footprint capability.  That is,
                  the record will have a capability element describing
                  the service.  The resource refered to may be the 
                  current one.  
               

\end{description}
\item[Element \xmlel{waveband}]
\begin{description}
\item[Type] string with controlled vocabulary
\item[Meaning] 
                  a named spectral region of the electro-magnetic spectrum 
                  that the resource's spectral coverage overlaps with.
               
\item[Occurrence] optional; multiple occurrences allowed.

\item[Allowed Values]\hfil
\begin{longtermsdescription}
\item[Radio]
                 wavelength >= 10 mm; frequency <= 30 GHz.
               
\item[Millimeter]
                 0.1 mm <= wavelength <= 10 mm; 
                 3000 GHz >= frequency >= 30 GHz.
               
\item[Infrared]
                 1 micron <= wavelength <= 100 micons 
               
\item[Optical]
                 300 nm <= wavelength <= 1000 nm; 
               
\item[UV]
                 100 nm <= wavelength <= 300 nm; 
               
\item[EUV]
                 12 eV <= energy <= 120 eV
               
\item[X-ray]
                 0.12 keV <= energy <= 120 keV
               
\item[Gamma-ray]
                 energy >= 120 keV
               
\end{longtermsdescription}

\end{description}
\item[Element \xmlel{regionOfRegard}]
\begin{description}
\item[Type] floating-point number: \xmlel{xs:float}
\item[Meaning] 
                  a single numeric value representing the angle, given
                  in decimal degrees, by which a positional query
                  against this resource should be “blurred” in order
                  to get an appropriate match. 
               
\item[Occurrence] optional
\item[Comment] 
                  In the case of image repositories, it might refer to
                  a typical field-of-view size, or the primary beam
                  size for radio aperture synthesis data.  In the case
                  of object catalogs RoR should normally be the
                  largest of the typical size of the objects, the
                  astrometric errors in the positions, or the
                  resolution of the data.  
               

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED



\subsection{Tabular Data}
\label{sect:table}


The \xmlel{vs:TableSet} type can be used
to describe a set of tables that are part of a single resource and can
be considered functionally all located at a single site.  While there is
no expectation that the table set directly corresponds to the responses
of tabular services,
services should not include metadata for purely internal
tables.



% GENERATED: !schemadoc VODataService-v1.2.xsd TableSet
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:TableSet} Type Schema Documentation}

\noindent{\small
           The set of tables hosted by a resource.
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:TableSet} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="TableSet" >
  <xs:sequence >
    <xs:element name="schema" type="vs:TableSchema" minOccurs="1"
              maxOccurs="unbounded" >
      <xs:unique name="DataCollection-tableName" >
        <xs:selector xpath="table" />
        <xs:field xpath="name" />
      </xs:unique>
    </xs:element>
  </xs:sequence>
  <xs:anyAttribute namespace="##other" />
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:TableSet} Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{schema}]
\begin{description}
\item[Type] composite: \xmlel{vs:TableSchema}
\item[Meaning] 
                A named description of a set of logically related tables.
              
\item[Occurrence] required; multiple occurrences allowed.
\item[Comment] 
                The name given by the “name” child element must
                be unique within this TableSet instance.  If there is
                only one schema in this set and/or there's no locally
                appropriate name to provide, the name can be set to
                “default”.  
              
\item[Comment] 
                This aggregation does not need to map to an
                actual database, catalog, or schema, though the
                publisher may choose to aggregate along such
                designations, or particular service protocol may
                recommend it.  
              

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED


The \xmlel{vs:TableSchema} type collects
tables together that are logically related.
For example, a single
resource may provide access several major astronomical catalogs
(e.g. SDSS, 2MASS, and FIRST) from one site, enabling high-performance
cross-correlations between them.  Each catalog can be described in a
separate \xmlel{schema} element, using the elements from
the \xmlel{vs:TableSchema} type.\todo{Is is a good idea to use
``default'' as the NULL value?  Or should we rather have minOccurs 0 for
title?}



% GENERATED: !schemadoc VODataService-v1.2.xsd TableSchema
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:TableSchema} Type Schema Documentation}

\noindent{\small
           A detailed description of a logically-related set of tables
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:TableSchema} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="TableSchema" >
  <xs:sequence >
    <xs:element name="name" type="xs:token" minOccurs="1" maxOccurs="1" />
    <xs:element name="title" type="xs:token" minOccurs="0" />
    <xs:element name="description" type="xs:token" minOccurs="0"
              maxOccurs="1" />
    <xs:element name="utype" type="xs:token" minOccurs="0" />
    <xs:element name="table" type="vs:Table" minOccurs="0"
              maxOccurs="unbounded" />
  </xs:sequence>
  <xs:anyAttribute namespace="##other" />
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:TableSchema} Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{name}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
               A name for the set of tables.  
             
\item[Occurrence] required
\item[Comment] 
               This is used to uniquely identify the table set among
               several table sets.  If a title is not present, this
               name can be used for display purposes.
             
\item[Comment] 
               If there is no appropriate logical name associated with
               this set, the name should be explicitly set to
               “default”.  
             

\end{description}
\item[Element \xmlel{title}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  a descriptive, human-interpretable name for the table set.
               
\item[Occurrence] optional
\item[Comment] 
                  This is used for display purposes.  There is no requirement
                  regarding uniqueness.  It is useful when there are
                  multiple schemas in the context (e.g., within a
                  tableset; otherwise, the resource title could be
                  used instead).
               

\end{description}
\item[Element \xmlel{description}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
               A free text description of the tableset that should
               explain in general how all of the tables are related.
             
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{utype}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  an identifier for a concept in a data model that
                  the data in this schema as a whole represent.  
               
\item[Occurrence] optional
\item[Comment] 
                  The form of the utype string depends on the data
                  model; common forms are sequences of dotted identifiers
                  (e.g., in SSA) or URIs (e.g., in RegTAP).
               

\end{description}
\item[Element \xmlel{table}]
\begin{description}
\item[Type] composite: \xmlel{vs:Table}
\item[Meaning] 
               A description of one of the tables that makes up the set.
             
\item[Occurrence] optional; multiple occurrences allowed.
\item[Comment] 
               The table names for the table should be unique.
             

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED


Each table in a schema is described in detail using the
\xmlel{vs:Table} type.



% GENERATED: !schemadoc VODataService-v1.2.xsd Table
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{1ex}\noindent\textbf{\xmlel{vs:Table} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="Table" >
  <xs:sequence >
    <xs:element name="name" type="xs:token" minOccurs="1" maxOccurs="1" />
    <xs:element name="title" type="xs:token" minOccurs="0" />
    <xs:element name="description" type="xs:token" minOccurs="0" />
    <xs:element name="utype" type="xs:token" minOccurs="0" />
    <xs:element name="nrows" type="xs:integer" minOccurs="0"
              maxOccurs="1" />
    <xs:element name="column" type="vs:TableParam" minOccurs="0"
              maxOccurs="unbounded" />
    <xs:element name="foreignKey" type="vs:ForeignKey" minOccurs="0"
              maxOccurs="unbounded" />
  </xs:sequence>
  <xs:attribute name="type" type="xs:string" />
  <xs:anyAttribute namespace="##other" />
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:Table} Attributes}

\begingroup\small\begin{bigdescription}
\item[type]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
               a name for the role this table plays.  Recognized
               values include “output”, indicating this table is output 
               from a query; “base\_table{"}, indicating a table
               whose records represent the main subjects of its
               schema; and “view”, indicating that the table represents
               a useful combination or subset of other tables.  Other 
               values are allowed.  
            
\item[Occurrence] optional
\end{description}


\end{bigdescription}\endgroup



\vspace{0.5ex}\noindent\textbf{\xmlel{vs:Table} Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{name}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  the fully qualified name of the table.  This name 
                  should include all catalog or schema prefixes
                  needed to sufficiently uniquely distinguish it in a
                  query.  
               
\item[Occurrence] required
\item[Comment] 
                  In general, the format of the qualified name may
                  depend on the context; however, when the
                  table is intended to be queryable via ADQL, then the
                  catalog and schema qualifiers are delimited from the
                  table name with dots (.).  
               

\end{description}
\item[Element \xmlel{title}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  a descriptive, human-interpretable name for the table.
               
\item[Occurrence] optional
\item[Comment] 
                  This is used for display purposes.  There is no requirement
                  regarding uniqueness.  
               

\end{description}
\item[Element \xmlel{description}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  a free-text description of the table's contents
               
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{utype}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  an identifier for a concept in a data model that
                  the data in this table represent.  
               
\item[Occurrence] optional
\item[Comment] 
                  The form of the utype string depends on the data
                  model; common forms are sequences of dotted identifiers
                  (e.g., in SSA) or URIs (e.g., in RegTAP).
               

\end{description}
\item[Element \xmlel{nrows}]
\begin{description}
\item[Type] integer
\item[Meaning] 
                  the size of the table in rows.
               
\item[Occurrence] optional
\item[Comment] 
                  This is not expected to be exact.  For instance, the
                  estimates on table sizes databases keep for query
                  planning purposes are suitable for this field.
               

\end{description}
\item[Element \xmlel{column}]
\begin{description}
\item[Type] composite: \xmlel{vs:TableParam}
\item[Meaning] 
                  a description of a table column.
               
\item[Occurrence] optional; multiple occurrences allowed.

\end{description}
\item[Element \xmlel{foreignKey}]
\begin{description}
\item[Type] composite: \xmlel{vs:ForeignKey}
\item[Meaning] 
                  a description of a foreign keys, one or more columns
                  from the current table that can be used to join with 
                  another table.  
               
\item[Occurrence] optional; multiple occurrences allowed.

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED




Each column in a table can be described using the
\xmlel{vs:TableParam} type which is described in
section~\ref{sect:param}.  The foreign keys in the table that
can be used to join it with another table can be described with the
\xmlel{vs:ForeignKey} type (section~\ref{sect:fkey}).
A foreign key description should only refer to tables described within
the current table set.  

When the table set describes a set of TAP-accessible tables, the value of
a \xmlel{table}'s \xmlel{name} child must be in a form immediately
usable for use in ADQL or SQL queries. This corresponds to the analogous
requirement for \tapschema.  This means that all qualifications (schema,
catalog) must be present, but also that when delimited
identifiers are used as table names on the relational side,
the quotes must be part of \xmlel{name}'s value, and the
capitalisation used in the DDL must be preserved.


The \xmlel{vs:Table} also provides an attribute for indicating
the role a table plays in the schema.





\subsubsection{Unique Names for Tables}
\label{sect:unique}


The definitions of the \xmlel{tableset} elements used in
the \xmlel{vs:DataCollection} and
\xmlel{vs:Catalog\-Ser\-vice} types
constrain certain names to be unique.  In particular, all schema names
within a \xmlel{tableset} element must be unique, and all
table names within a \xmlel{schema} element must be
unique.  (A schema and table may share a common name, such as
``default''.)  These constraints makes it possible to uniquely locate
the description of a schema or table within a VOResource description.  

Name uniqueness is only required when the table set description is
part of a VOResource description.  The name uniqueness rules
\emph{should} also be applied to other uses of the
\xmlel{vs:TableSet} element outside of a VOResource
description.  


\subsubsection{Foreign Keys}
\label{sect:fkey}


The \xmlel{vs:ForeignKey} type allows one to describe foreign
keys in a table that allow it to be joined effectively with another
table.  A foreign key is a set of columns that map to a corresponding
set of columns in another table.  


% GENERATED: !schemadoc VODataService-v1.2.xsd ForeignKey
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:ForeignKey} Type Schema Documentation}

\noindent{\small
           A description of the mapping a foreign key--a set of 
           columns from one table--to columns in another table.  
         \par}

\noindent{\small
           This definition that the foreign key is being described 
           within the context of the table containing the key.  
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:ForeignKey} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="ForeignKey" >
  <xs:sequence >
    <xs:element name="targetTable" type="xs:token" />
    <xs:element name="fkColumn" type="vs:FKColumn" minOccurs="1"
              maxOccurs="unbounded" />
    <xs:element name="description" type="xs:token" minOccurs="0" />
    <xs:element name="utype" type="xs:token" minOccurs="0" />
  </xs:sequence>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:ForeignKey} Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{targetTable}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
               the fully-qualified name (including catalog and schema, as
               applicable) of the table that can be joined with the 
               table containing this foreign key.
             
\item[Occurrence] required

\end{description}
\item[Element \xmlel{fkColumn}]
\begin{description}
\item[Type] composite: \xmlel{vs:FKColumn}
\item[Meaning] 
               a pair of column names, one from this table and one
               from the target table that should be used to join the
               tables in a query.  
             
\item[Occurrence] required; multiple occurrences allowed.

\end{description}
\item[Element \xmlel{description}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  a free-text description of what this key points to
                  and what the relationship means.  
               
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{utype}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  an identifier for a concept in a data model that
                  the association enabled by this key represents.  
               
\item[Occurrence] optional
\item[Comment] 
                  The form of the utype string depends on the data
                  model; common forms are sequences of dotted identifiers
                  (e.g., in SSA) or URIs (e.g., in RegTAP).
               

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED


In this model, the source of the foreign
key is the current table being described (i.e. represented by the
\xmlel{table} element that contains the
\xmlel{vs:ForeignKey} description, and thus does not need to be
named explicitly).  The key that is described points to the table
given by the \xmlel{targetTable} child element.  Each child
\xmlel{fkColumn} element then gives a pair of columns, one
from the source table and one from the target table, that can be
constrained to be equal in a query that joins the two tables.  






\subsubsection{Extending Table Metadata}
\label{sect:tblext}

It is envisioned that it may be useful in the future to provide richer
metadata for describing tables within a VOResource description than
what are defined in this document.  This document recommends the
use of the following extension mechanisms when richer descriptions are
desired:

\begin{enumerate}
\item Use extended types by applying the \xmlel{xsi:type}
       attribute to the \xmlel{tableset},
       \xmlel{schema}, \xmlel{table}, 
       \xmlel{column} and/or
       \xmlel{dataType} elements.  The values provided in the
       attributes must refer to an XML type legally extended from the types
       associated with these elements according to the rules of XML Schema
       \citep{std:XSD} and the VOResource specification.

\item Apply a globally-defined attribute from a schema other than
       VODataService (i.e. from a namespace other than
       \url{http://www.ivoa.net/xml/VODataService/v1.1}) to any of the
       \xmlel{tableset}, \xmlel{schema},
       \xmlel{table}, and/or \xmlel{column}
       elements.

\item When the extended metadata is specific to how the table data is
       accessed via a particular service protocol, then the new
       metadata can be incorporated into a specific capability
       extension (as described in the VOResource specification).  
       This extension may make use of the
       various names within the \xmlel{tableset} to
       indicate where the extension metadata apply.

\item Use the \xmlel{extendedType} attribute of the
       \xmlel{dataType} element (see 
       section~\ref{sect:tbldatatypes}).
       to indicate a more specific data type then those defined by the
       \xmlel{vs:TableParam} type.
\end{enumerate}

\subsection{Interface Type Extension: ParamHTTP}
\label{sect:paramif}


The \xmlel{vs:ParamHTTP} type is a specialized service interface
description that extends the VOResource \xmlel{vr:Interface} type 
(as recommended by VOResource 1.1, section 2.2).  It
describes a service interface that is invoked over HTTP via a GET or a
POST in which the inputs are parameters
encoded in multipart/form-data or application/x-www-form-urlencoded
containers.

% GENERATED: !schemadoc VODataService-v1.2.xsd ParamHTTP
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:ParamHTTP} Type Schema Documentation}

\noindent{\small
           A service invoked via an HTTP Query (either Get or Post)
           with a set of arguments consisting of keyword name-value pairs.
        \par}

\noindent{\small
           Note that the URL for help with this service can be put into
           the Service/ReferenceURL element.
        \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:ParamHTTP} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="ParamHTTP" >
  <xs:complexContent >
    <xs:extension base="vr:Interface" >
      <xs:sequence >
        <xs:element name="queryType" type="vs:HTTPQueryType" minOccurs="0"
                  maxOccurs="2" />
        <xs:element name="resultType" type="xs:token" minOccurs="0"
                  maxOccurs="1" />
        <xs:element name="param" type="vs:InputParam" minOccurs="0"
                  maxOccurs="unbounded" />
        <xs:element name="testQuery" type="xs:string" minOccurs="0"
                  maxOccurs="unbounded" />
      </xs:sequence>
    </xs:extension>
  </xs:complexContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:ParamHTTP} Extension Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{queryType}]
\begin{description}
\item[Type] string with controlled vocabulary
\item[Meaning] 
                       The type of HTTP request, either GET or POST.
                     
\item[Occurrence] optional; up to 2 occurrences allowed.

\item[Allowed Values]\hfil
\begin{longtermsdescription}
\item[GET]
\item[POST]
\end{longtermsdescription}
\item[Comment] 
                       The service may indicate support for both GET
                       and POST by providing 2 queryType elements, one
                       with GET and one with POST.
                     

\end{description}
\item[Element \xmlel{resultType}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                       The MIME type of a document returned in the HTTP response.
                     
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{param}]
\begin{description}
\item[Type] composite: \xmlel{vs:InputParam}
\item[Meaning] 
                       a description of a input parameter that can be 
                       provided as a name=value argument to the service.  
                    
\item[Occurrence] optional; multiple occurrences allowed.

\end{description}
\item[Element \xmlel{testQuery}]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
                       an ampersand-delimited list of arguments that
                       can be used to test this service interface; 
                       when provided as the input to this interface,
                       it will produce a legal, non-null response.
                    
\item[Occurrence] optional; multiple occurrences allowed.
\item[Comment] 
                       When the interface supports GET, then the full 
                       query URL is formed by the concatonation of the 
                       base URL (given by the accessURL) and the value 
                       given by this testQuery element.  
                    

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED

The extension metadata defined in the schema definition above are all
optional.  Nevertheless, even when an \xmlel{interface}
instance does not include any of these extended child elements, the
use of \verb|xsi:type="vs:ParamHTTP"| indicates that the interface
accessed via the URL given by the \xmlel{accessURL}
element complies with the general parameter-based protocol described
in this section.\todo{resultType stinks when we have DALI
RESPONSEFORMAT.  Would anyone miss it?  If so, how can we fix it?}






A important intended use of the \xmlel{vs:ParamHTTP} type is
describing the interface of an IVOA standard service protocol 
of the ``simple'' variety, such as the Simple Image Access Protocol
\citep{2015ivoa.spec.1223D}.  In particular, it is recommended that
specifications that define how a standard service is registered in a
registry \emph{require} the use of the \xmlel{vs:ParamHTTP}
interface type when it is applicable.



Normally, a VOResource
description indicates its support for a standard protocol with
\xmlel{capability} element having a
\xmlel{standardID} attribute set to specific URI representing the
standard.  The standard will usually spell out the HTTP query type,
the returned media type, and input parameters required for compliance;
therefore, it is not necessary that the \xmlel{vs:ParamHTTP}
description provide any of the optional extended metadata, as they are
already implied by the \xmlel{standardID}.  The description need
only reflect the optional or locally unique features of the
interface.  In particular, description may include


\begin{itemize}
\item a \xmlel{queryType} element for a type that is not
  required by the standard (as long as the required query type is
  supported as well),

\item \xmlel{param}\/ elements for any optional parameters
       or local extended parameters (when allowed by the standard).
\end{itemize}


Of course, listing required parameters is always allowed, even when
describing a standard interface as long as these are consistent with
the service specification and the corresponding \xmlel{param}
elements include the attribute \verb|use="required"| (see
section~\ref{sect:inputparam}.  The \xmlel{param}
elements for custom parameters that are not part of the standard (but
are rather local customizations) should include the attribute
\verb|std="false"|.





\subsection{Data Parameters}
\label{sect:param}


The VODataService schema provides several element types for describing
different kinds of data parameters used in datasets and services,
including service input parameters and table columns.  The parameter
types allow one to fully describe a parameter in terms of metadata
that includes name, data type, and meaning.  


All the VODataService parameter types derive from a base type called
\xmlel{vs:BaseParam} which defines all the common parameter
metadata except the data type.  


% GENERATED: !schemadoc VODataService-v1.2.xsd BaseParam
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:BaseParam} Type Schema Documentation}

\noindent{\small
            a description of a parameter that places no restriction on 
            the parameter's data type.
         \par}

\noindent{\small
            As the parameter's data type is usually important, schemas
            normally employ a sub-class of this type (e.g., Param),
            rather than this type directly.
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:BaseParam} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="BaseParam" >
  <xs:sequence >
    <xs:element name="name" type="xs:token" minOccurs="0" />
    <xs:element name="description" type="xs:token" minOccurs="0" />
    <xs:element name="unit" type="xs:token" minOccurs="0" />
    <xs:element name="ucd" type="xs:token" minOccurs="0" />
    <xs:element name="utype" type="xs:token" minOccurs="0" />
  </xs:sequence>
  <xs:anyAttribute namespace="##other" />
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:BaseParam} Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{name}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  the name of the parameter or column
               
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{description}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  a free-text description of a parameter's or column's 
                  contents
               
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{unit}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  the unit associated with the values in the parameter
                  or column
               
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{ucd}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  the name of a unified content descriptor that
                  describes the scientific content of the parameter.  
               
\item[Occurrence] optional
\item[Comment] 
                  There are no requirements for compliance with any 
                  particular UCD standard.  The format of the UCD can
                  be used to distinguish between UCD1, UCD1+, and
                  SIA-UCD.  See 
                  http://ivoa.net/Documents/latest/UCDlist.html
                  for the latest IVOA standard set.  
               

\end{description}
\item[Element \xmlel{utype}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                  an identifier for a concept in a data model that
                  the data in this schema represent.  
               
\item[Occurrence] optional
\item[Comment] 
                  The form of the utype string depends on the data
                  model; common forms are sequences of dotted identifiers
                  (e.g., in SSA) or URIs (e.g., in RegTAP).
               

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED

Leaving the data type metadatum out of \xmlel{vs:BaseParam}
allows the different kinds of parameters derived from
\xmlel{vs:BaseParam} to restrict the allowed data types to
specific sets.  The subsections below describe the different data
types associated with input parameters
(\xmlel{vs:InputParam}) and table
columns (\xmlel{vs:TableParam}).  The
XML types associated with their \xmlel{dataType} elements
derive from a common parent, \xmlel{vs:DataType}.


% GENERATED: !schemadoc VODataService-v1.2.xsd DataType
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:DataType} Type Schema Documentation}

\noindent{\small
            a type (in the computer language sense) associated with a 
            parameter with an arbitrary name
         \par}

\noindent{\small
            This XML type is used as a parent for defining data types
            with a restricted set of names.
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:DataType} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="DataType" >
  <xs:simpleContent >
    <xs:extension base="xs:token" >
      <xs:attribute name="arraysize" type="vs:ArrayShape" />
      <xs:attribute name="delim" type="xs:string" />
      <xs:attribute name="extendedType" type="xs:string" />
      <xs:attribute name="extendedSchema" type="xs:anyURI" />
      <xs:anyAttribute namespace="##other" />
    </xs:extension>
  </xs:simpleContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:DataType} Attributes}

\begingroup\small\begin{bigdescription}
\item[arraysize]
\begin{description}
\item[Type] string of the form: \emph{([0-9]+x)*[0-9]*[0-9*]}
\item[Meaning] 
                     the shape of the array that constitutes the value
                  
\item[Occurrence] optional

\item[Comment] 
                     Leave arraysize empty for scalar values.  In version 1.1,
                     this defaulted to 1, which was intended to indicate
                     a scalar.  This is now deprecated; an arraysize of 1 should
                     be avoided now, the future interpretation, in accord with
                     VOTable, will be “array of size 1”.
                  
\end{description}
\item[delim]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
                     a string that is used to delimit elements of an array
                     value in InputParams.
                  
\item[Occurrence] optional
\item[Comment] 
                     Unless specifically disallowed by the context, 
                     applications should allow optional spaces to 
                     appear in an actual data value before and after 
                     the delimiter (e.g., “1, 5” when delim=“,”).
                  
\item[Comment] 
                     This should not be used for VOTable types; there,
                     VOTable (typcially TABLEDATA) conventions for writing
                     arrays are binding.
                  
\end{description}
\item[extendedType]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
                     The data value represented by this type can be
                     interpreted as of a custom type identified by 
                     the value of this attribute.
                  
\item[Occurrence] optional
\item[Comment] 
                     If an application does not recognize this
                     extendedType, it should attempt to handle value
                     assuming the type given by the element's value.
                     string is a recommended default type.
                  
\item[Comment] 
                     This element may make use of the extendedSchema
                     attribute to refine the identification of the 
                     type.  extendedTypes without an extendedSchema 
                     mean VOTable xtypes as defined by DALI.
                  
\end{description}
\item[extendedSchema]
\begin{description}
\item[Type] a URI: \xmlel{xs:anyURI}
\item[Meaning] 
                     An identifier for the schema that the value given
                     by the extended attribute is drawn from.
                  
\item[Occurrence] optional
\item[Comment] 
                     This attribute is normally ignored if the
                     extendedType attribute is not present.  A missing
                     extendedSchema indicates that extendedType is a
                     VOTable xtype.
                  
\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED

The content of an element of type \xmlel{vs:DataType} is the name
of the data type for the current parameter.  When the element is explicitly
a \xmlel{vs:DataType} (as opposed to one of its derived types),
there are no restrictions on the names that may be included.  



A data type description can be augmented via a common set of
\xmlel{vs:DataType} attributes, defined below.  The
\xmlel{arraysize} attribute indicates the parameter is an array
of values of the named type.  Its value describes the shape of the
array. When there is no natural serialisation defined through the type
system, the \xmlel{delim} attribute may be used to indicate
a delimiter that should appear between elements of an array value.  This
attribute must not be combined with VOTableDataType, which always
uses VOTable serialisation rules.



More descriptive information about the type can be provided via
\xmlel{extendedType} and \xmlel{extendedSchema}, which
provide an alternate data type name.  It is expected that this name
will only be understood by a special subset of applications.  The name
given in the element content, then, represents a more commonly
understood “fall-back” type.   Arbitrary information can also be
provided via any prefix-qualified, globally defined attribute drawn
from an XML Schema other than VODataService (by virtue of the
\xmlel{xs:anyAttribute} specification present
on \xmlel{vs:DataType}).





Note that in the derived parameter description types described below,
the \xmlel{dataType} element is optional.  Its absence
from the parameter description does \emph{not} mean that the
parameter can support any data type; rather, it means that the data
type simply has not been provided (which may limit what an application
can do with the parameter).  If a parameter can truly support any data
type, the \xmlel{vs:BaseParam} type can be used directly when the
context permits.  


\subsubsection{Input Parameters}
\label{sect:inputparam}


Actual parameters are normally described with types derived from
\xmlel{vs:BaseParam}.  The \xmlel{vs:InputParam} is intended
for describing an input parameter to a service or function.  The
allowed data type names (given in the metadata table below) do not
imply a size or precise format; rather, they are intended to be
sufficient for describing an input paramter to a simple REST-like
service or a function in a weakly-typed (e.g. scripting) language.  


% GENERATED: !schemadoc VODataService-v1.2.xsd InputParam
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:InputParam} Type Schema Documentation}

\noindent{\small
            a description of a service or function parameter having a
            fixed data type. 
         \par}

\noindent{\small
            The allowed data type names do not imply a size or precise
            format.  This type is intended to be sufficient for describing
            an input parameter to a simple REST service or a function 
            written in a weakly-typed (e.g., scripting) language.
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:InputParam} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="InputParam" >
  <xs:complexContent >
    <xs:extension base="vs:BaseParam" >
      <xs:sequence >
        <xs:element name="dataType" type="vs:SimpleDataType" minOccurs="0" />
      </xs:sequence>
      <xs:attribute name="use" type="vs:ParamUse" default="optional" />
      <xs:attribute name="std" type="xs:boolean" default="true" />
    </xs:extension>
  </xs:complexContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:InputParam} Attributes}

\begingroup\small\begin{bigdescription}
\item[use]
\begin{description}
\item[Type] string with controlled vocabulary
\item[Meaning] 
                     An indication of whether this parameter is
                     required to be provided for the application
                     or service to work properly.  
                  
\item[Occurrence] optional

\item[Allowed Values]\hfil
\begin{longtermsdescription}
\item[required]
                  the parameter is required for the application or
                  service to work properly.  
               
\item[optional]
                  the parameter is optional but supported by the application or
                  service.
               
\item[ignored]
                  the parameter is not supported and thus is ignored by the 
                  application or service.
               
\end{longtermsdescription}
optional
\item[Comment] 
                     Allowed values are “required” and “optional”.
                  
\end{description}
\item[std]
\begin{description}
\item[Type] boolean (true/false): xs:boolean
\item[Meaning] 
                     If true, the meaning and behavior of this parameter is
                     reserved and defined by a standard interface.  If
                     false, it represents an implementation-specific
                     parameter that effectively extends the behavior of the 
                     service or application.  
                  
\item[Occurrence] optional
true
\end{description}


\end{bigdescription}\endgroup



\vspace{0.5ex}\noindent\textbf{\xmlel{vs:InputParam} Extension Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{dataType}]
\begin{description}
\item[Type] composite: \xmlel{vs:SimpleDataType}
\item[Meaning] 
                        a type of data contained in the parameter
                     
\item[Occurrence] optional

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED


By fixing the \xmlel{dataType} child element to that of the
\xmlel{vs:SimpleDataType}, the possible types are restricted to
predefined set appropriate for input parameters.\todo{On the other hand,
also allowing VOTable types here would help a lot with, e.g., SODA and
friends.  Anyone objecting to opening up the type system here?}



The \xmlel{vs:InputParam} type accepts two attributes that
indicate the role that the parameter plays as input to the service or
function.


Here is an example for a description
of an input parameter that might appear inside an
\xmlel{vs:ParamHTTP} interface description.  As noted in
section~\ref{sect:paramif}, a \xmlel{param}
element uses the \xmlel{vs:InputParam} type to describe itself:

\begin{lstlisting}[language=XML]
<param use="required">
  <name> radius </name>
  <description>
    search radius; returned objects are restricted to fall 
    within this angular distance of the search position.
  </description>
  <ucd> phys.angSize </ucd>
  <dataType> real </dataType>
</param>
\end{lstlisting}

\subsubsection{Table Columns}
\label{sect:columns}


The \xmlel{vs:TableParam} is also derived from
\xmlel{vs:BaseParam}, and is designed for describing a column of
a table.


% GENERATED: !schemadoc VODataService-v1.2.xsd TableParam
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:TableParam} Type Schema Documentation}

\noindent{\small
            a description of a table parameter having a fixed data type.
         \par}

\noindent{\small
            The allowed data type names match those supported by VOTable.
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:TableParam} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="TableParam" >
  <xs:complexContent >
    <xs:extension base="vs:BaseParam" >
      <xs:sequence >
        <xs:element name="dataType" type="vs:TableDataType" minOccurs="0" />
        <xs:element name="flag" type="xs:token" minOccurs="0"
                  maxOccurs="unbounded" />
      </xs:sequence>
      <xs:attribute name="std" type="xs:boolean" />
    </xs:extension>
  </xs:complexContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:TableParam} Attributes}

\begingroup\small\begin{bigdescription}
\item[std]
\begin{description}
\item[Type] boolean (true/false): xs:boolean
\item[Meaning] 
                     If true, the meaning and use of this parameter is
                     reserved and defined by a standard model.  If false, 
                     it represents a database-specific parameter 
                     that effectively extends beyond the standard.  If
                     not provided, then the value is unknown.
                  
\item[Occurrence] optional
\end{description}


\end{bigdescription}\endgroup



\vspace{0.5ex}\noindent\textbf{\xmlel{vs:TableParam} Extension Metadata Elements}

\begingroup\small\begin{bigdescription}\item[Element \xmlel{dataType}]
\begin{description}
\item[Type] \xmlel{vs:DataType} with optional attributes
\item[Meaning] 
                        a type of data contained in the column
                     
\item[Occurrence] optional

\end{description}
\item[Element \xmlel{flag}]
\begin{description}
\item[Type] string: \xmlel{xs:token}
\item[Meaning] 
                        a keyword representing traits of the column.  
                        Recognized values include “indexed”, “primary”, and
                        “nullable”.  
                     
\item[Occurrence] optional; multiple occurrences allowed.
\item[Comment] 
                        See the specification document for definitions 
                        of recognized keywords.
                     

\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED


A table column's data type is indicated with the \xmlel{dataType}
element with a name drawn from a standard set of names.  
Because \xmlel{dataType}'s
XML type, \xmlel{vs:TableDataType}, is abstract, the
element MUST include an
\xmlel{xsi:type} attribute.  As discussed in
sect.~\ref{sect:tbldatatypes}, this should generally be
\xmlel{vs:VOTableType} for VODataService 1.2 table columns.

When the tableset describes a set of TAP-accessible tables, the value of
a \xmlel{tableColumn}'s \xmlel{name} child must be in a form immediately
usable for use in ADQL or SQL queries. This corresponds to the analogous
requirement for \tapschema\ and is usually only a problem when delimited
identifiers are used for column names on the relational side.  In that
case, the quotes must be part of \xmlel{name}'s value, and the
capitalisation used in the DDL must be preserved.


As examples, here are declarations of a column called ``Dec'' containing
a double-valued declination, of the (deprecated) \verb|size| column
from TAP 1.0 which requires quotes because it otherwise clashes with a
SQL reserved name, and a SIAP 1.0-compatible \verb|wcs_cdmatrix|
column that shows how multidimensional arrays are declared:

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<column>
   <name> Dec </name>
   <description> the J2000 declination of the object </description>
   <ucd> pos.eq.dec </ucd>
   <dataType xsi:type="vs:VOTableType"> double </dataType>
</column>

<column>
  <name>"size"</name>
  <description>Length of variable length datatypes</description>
  <dataType xsi:type="vs:VOTableType">int</dataType>
  <flag>nullable</flag>
</column>

<column>
  <name>wcs_cdmatrix</name>
  <description>World coordinates at WCS reference pixel</description>
  <unit>deg</unit>
  <ucd>VOX:WCS_CoordRefValue</ucd>
  <dataType arraysize="2x2" xsi:type="vs:VOTableType">double</dataType>
  <flag>nullable</flag>
</column>
\end{lstlisting}


\subsubsection{Table Column Data Types}
\label{sect:tbldatatypes}


The VODataService schema defines two XML types that derive from
\xmlel{vs:TableDataType}:  \xmlel{vs:VOTableType} and
\xmlel{vs:TAPType}.  Following the move to VOTable-compatible type
descriptions in TAP 1.1 \citep{todo:TAP1.1}, this version of
VODataService deprecates the use of \xmlel{vs:TAPType}.  New software
should only generate \xmlel{vs:VOTableType}s in \xmlel{tableset}s.


% GENERATED: !schemadoc VODataService-v1.2.xsd VOTableType
\begin{generated}
\begingroup
      	\renewcommand*\descriptionlabel[1]{%
      	\hbox to 5.5em{\emph{#1}\hfil}}\vspace{2ex}\noindent\textbf{\xmlel{vs:VOTableType} Type Schema Documentation}

\noindent{\small
            a data type supported explicitly by the VOTable format
         \par}

\vspace{1ex}\noindent\textbf{\xmlel{vs:VOTableType} Type Schema Definition}

\begin{lstlisting}[language=XML,basicstyle=\footnotesize]
<xs:complexType name="VOTableType" >
  <xs:simpleContent >
    <xs:restriction base="vs:TableDataType" >
      <xs:enumeration value="boolean" />
      <xs:enumeration value="bit" />
      <xs:enumeration value="unsignedByte" />
      <xs:enumeration value="short" />
      <xs:enumeration value="int" />
      <xs:enumeration value="long" />
      <xs:enumeration value="char" />
      <xs:enumeration value="unicodeChar" />
      <xs:enumeration value="float" />
      <xs:enumeration value="double" />
      <xs:enumeration value="floatComplex" />
      <xs:enumeration value="doubleComplex" />
      <xs:attribute name="arraysize" type="vs:ArrayShape" />
      <xs:attribute name="delim" type="xs:string" default=" " />
      <xs:attribute name="extendedType" type="xs:string" />
      <xs:attribute name="extendedSchema" type="xs:anyURI" />
      <xs:anyAttribute namespace="##other" />
    </xs:restriction>
  </xs:simpleContent>
</xs:complexType>
\end{lstlisting}

\vspace{0.5ex}\noindent\textbf{\xmlel{vs:VOTableType} Attributes}

\begingroup\small\begin{bigdescription}
\item[arraysize]
\begin{description}
\item[Type] string of the form: \emph{([0-9]+x)*[0-9]*[0-9*]}
\item[Meaning] 
\item[Occurrence] optional

\end{description}
\item[delim]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
\item[Occurrence] optional
 
\end{description}
\item[extendedType]
\begin{description}
\item[Type] string: \xmlel{xs:string}
\item[Meaning] 
\item[Occurrence] optional
\end{description}
\item[extendedSchema]
\begin{description}
\item[Type] a URI: \xmlel{xs:anyURI}
\item[Meaning] 
\item[Occurrence] optional
\end{description}


\end{bigdescription}\endgroup

\endgroup
\end{generated}

% /GENERATED



In general, the \xmlel{vs:TableParam}'s \xmlel{dataType}
can support any non-abstract type legally derived from
\xmlel{vs:TableDataType}.  However, in the context of a
\xmlel{vs:DataCollection} or \xmlel{vs:CatalogService}
resource description, it is strongly recommended that 
\xmlel{vs:VOTableType}  be used to
ensure maximum interoperability.  

When the actual column type is not
well matched to a VOTable data type, authors are
encouraged to use the \xmlel{extendedType} attribute to refer to
a more specific type.  This will usually be a VOTable \xmlel{xtype} as
defined by DALI \citep{2017ivoa.spec.0517D}.  Using different extended
type schemes is possible by setting \xmlel{extendedSchema} to a
non-empty value; data providers using this extension mechanism should
explain their schema in an IVOA Note.

\appendix

\section{Changes from previous versions}

\subsection{Changes from REC-1.1}

\begin{itemize}
\item Deprecated STCResourceProfile and replaced it with
\xmlel{spatial}, \xmlel{temporal}, and \xmlel{spectral} elements.
\item Introduced new DataResource and CatalogResource resource types
and wove them into the inheritance hierarchy to CatalogService; these
are to be used for ``dependent'' resources.
\item Deprecated DataCollection and StandardSTC (which are no longer
needed).
\item Added an nrows element to \xmlel{vs:Table}.
\item Required inclusion of quotes for delimited identifiers in a
SQL context.
\item DataType/@arraysize no longer defaults to 1, and the
interpretation of arraysize=1 as a scalar is withdrawn.  Use empty
arraysize for scalars now.
\item BaseParam's delim attribute no longer defaults to blank.  That
would be very unfortunate with VOTable, where other conventions are in
place (e.g., for string arrays).  Now discouraging the use of delim
outside of InputParams.
\item Deprecated TAPType.
\item No longer requiring unique table names within a tableset;
uniquness is now required within a schema (actually, many services have
been in violation of the old unique-within-tableset rule for a long time
without operational difficulties).
\item Ported source to \ivoatex.
\end{itemize}

\subsection{Changes since PR-20100916}

\begin{itemize}
  \item updated status for elevation to Recommendation.
  \item cleaned-up mis-labeled and mis-ordered change history.
\end{itemize}

\subsection{Changes since PR-20100914}

\begin{itemize}
  \item added change history for PR-20100412.
  \item added Note about STC mark-up in 3.2
  \item reworded sentence describing content of \xmlel{vs:DataType} in
       section 3.5.
\end{itemize}

\subsection{Changes since PR-20100412}

\begin{itemize}
  \item fix numerous typos discovered in TCG review
  \item added section 1.1 to describe role of standard in the VO
       architecture, including diagram.
  \item corrected frequency range for the UV waveband
  \item corrected links to reference documents
\end{itemize}

\subsection{Changes since PR-20090903}

\begin{itemize}
  \item added \xmlel{testQuery}
       to \xmlel{vs:ParamHTTP}
  \item in text, added explanation of
       \xmlel{vs:Format}
  \item grammatical clean-up
\end{itemize}

\subsection{Changes since WD-20090508 (v1.10)}

\begin{itemize}
  \item corrected errors in example in Introduction
  \item added \xmlel{description} and
       \xmlel{utype} elements to the
       \xmlel{vs:ForeignKey} type for consistency with TAP.
  \item changed type names \xmlel{vs:TAP} to
       \xmlel{vs:TAPType} and \xmlel{vs:VOTable}
       \xmlel{vs:VOTableType}.
\end{itemize}

\bibliography{ivoatex/ivoabib,ivoatex/docrepo,local}

\end{document}
